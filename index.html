<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Public Survey Form</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #eef2f7;
      margin: 0;
      padding: 20px;
border: 1;
    }

    .container {
      background: #fff;
      max-width: 700px;
      margin: auto;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
	.survey-container1 {
      	background: #fff;
      	max-width: 700px;
      	margin: auto;
      	padding: 10px;
      	border-radius: 12px;
      	box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
	.responsive-img {
  	max-width: 100%;
  	height: auto;
  	display: block;
 	 margin: auto;
}

    h2 {
      text-align: center;
      color: #333;
      margin-bottom: 5px;
    }

    label {
      font-weight: 600;
      margin-top: 15px;
      display: block;
      color: #444;
    }

    input, select {
      width: 100%;
      padding: 10px;
      margin-top: 6px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 16px;
    }

    button {
      background-color: #0066cc;
      color: white;
      padding: 12px 20px;
      margin-top: 25px;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
      width: 100%;
    }

    button:hover {
      background-color: #004d99;
    }

    @media (max-width: 600px) {
      .survey-container {
        padding: 20px;
      }
    }
  </style>
</head>
<body>
<div id="pdfContent">
<div class="container">
<div class="survey-container1">
	<img src="https://drive.google.com/thumbnail?id=1MaO5_nI2f8dxt-r1wFCZda8F1ONi4g0x&sz=s800" alt="Image from Google Drive"
  class="responsive-img"//>
  		<center><h2><u>рд░рд╛рд╢рдирдХрд╛рд░реНрдб рдореЗрдВ рдЙрдкрд▓рдмреНрдз рд╕рдВрджрд┐рдЧреНрдз рд▓рд╛рднрд╛рд░реНрдереА рдкрд░ рдХрд╛рд░реНрдпрд╡рд╛рд╣реА рдХреА рдЬрд╛рдирдХрд╛рд░реА</u></h2>
		<h5>(рдРрд╕реЗ рд░рд╛рд╢рдирдХрд╛рд░реНрдб рдЬрд┐рд╕рдореЗ рд╕рджрд╕реНрдп рдХреЗ рдЖрдзрд╛рд░ рдбреБрдкреНрд▓рд┐рдХреЗрдЯ рд╣реИ, рд╕рджрд╕реНрдп рдЬрд┐рдирдХреА рдЙрдореНрд░ 100 рд╕реЗ рдЕрдзрд┐рдХ рд╣реИ, 12 рдорд╣реАрдиреЛ рд╕реЗ рдЕрдзрд┐рдХ- рдЙрдард╛рд╡ рди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд░рд╛рд╢рди рдХрд╛рд░реНрдб, 
		6-12 рдорд╣реАрдиреЛ рд╕реЗ рдЕрдзрд┐рдХ- рдЙрдард╛рд╡ рди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд░рд╛рд╢рди рдХрд╛рд░реНрдб, рдПрд╡рдВ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдЖрдзрд╛рд░ рдЙрдХреНрдд рдХрд╛рд░рдгреЛ рд╕реЗ рд╕рдВрджрд┐рдЧреНрдз рд▓рд╛рднрд╛рд░реНрдереА рдХреА рд╢реНрд░реЗрдгреА рдореЗ рд╣реИ )</h5></center></div>
  <form id="form">
    		<label for="ID">рд░рд╛рд╢рдирдХрд╛рд░реНрдб рдХреНрд░рдорд╛рдВрдХ :-</label>
<input type="tel" id="RashanCard" name="rashanCard" placeholder="12 рдЕрдВрдХреЛ рдХрд╛ рд░рд╛рд╢рдХрд╛рд░реНрдб рдирдВрдмрд░ рдбрд╛рд▓реЗ " pattern="[0-9]{12}" maxlength="12"  title="twenty digits code" required/>
			<label for="name">рд╣рд┐рддрдЧреНрд░рд╛рд╣реА рдХрд╛ рдирд╛рдо :-</label>
			<input type="text" id="ResidentName"name="residentName" placeholder="рд╣рд┐рддрдЧреНрд░рд╛рд╣реА  рдХрд╛ рдирд╛рдо рд▓рд┐рдЦреЗ (рд╣рд┐рдиреНрджреА рдореЗ)" required>
    <label for="Iname">рд╕рддреНрдпрд╛рдкрдирдХрд░реНрддрд╛ рдЕрдзрд┐рдХрд╛рд░реА рдХрд╛ рдкрджрдирд╛рдо :-</label>
     <select id="Designation" name="designation" required>
	<option value="" disabled selected>рд╕рддреНрдпрд╛рдкрдирдХрд░реНрддрд╛ рдЕрдзрд┐рдХрд╛рд░реА рдХрд╛ рдкрджрдирд╛рдо рдЪреБрдиреЗ </option>
	 <option value="рдЦрд╛рджреНрдп рдЕрдзрд┐рдХрд╛рд░реА">рдЦрд╛рджреНрдп рдЕрдзрд┐рдХрд╛рд░реА</option>
	<option value="рдЦрд╛рджреНрдп рдирд┐рд░реАрдХреНрд╖рдХ">рдЦрд╛рджреНрдп рдирд┐рд░реАрдХреНрд╖рдХ </option>
	<option value="рд░рд╛рдЬрд╕реНрд╡ рдирд┐рд░реАрдХреНрд╖рдХ">рд░рд╛рдЬрд╕реНрд╡ рдирд┐рд░реАрдХреНрд╖рдХ</option>
	<option value="рдкрдЯрд╡рд╛рд░реА">рдкрдЯрд╡рд╛рд░реА</option>
	<option value="рдкрдВрдЪрд╛рдпрдд рд╕реАрдИрдУ">рдкрдВрдЪрд╛рдпрдд рд╕реАрдИрдУ</option>
	<option value="рдкрдВрдЪрд╛рдпрдд рд╕рдЪрд┐рд╡ (рдЧреНрд░рд╛рдо рд╕рдЪрд┐рд╡)">рдкрдВрдЪрд╛рдпрдд рд╕рдЪрд┐рд╡ (рдЧреНрд░рд╛рдо рд╕рдЪрд┐рд╡)</option>
	<option value="рдЕрдиреНрдп">рдЕрдиреНрдп</option>
	</select>
	<label for="name">рд╕рддреНрдпрд╛рдкрдирдХрд░реНрддрд╛ рдЕрдзрд┐рдХрд╛рд░реА рдХрд╛ рдирд╛рдо :-</label>
	<input type="text" id="OfficerName" name="officerName" placeholder="рд╕рддреНрдпрд╛рдкрдирдХрд░реНрддрд╛ рдЕрдзрд┐рдХрд╛рд░реА рдХрд╛ рдирд╛рдо " required>
    <label for="dob">рд╕рддреНрдпрд╛рдкрди рджрд┐рдирд╛рдБрдХ :-</label>
    <input type="date" id="VerificationDate" name="verificationDate" required>

    <label for="country">рджрд╕реНрддрд╛рд╡реЗрдЬ рдкреНрд░рдорд╛рдг :-</label>
    <select id="DocumentProof" name="documentProof" required>
      <option value="" disabled selected> рд╕рдВрдмрдиреНрдзрд┐рдд рджрд╕реНрддрд╛рд╡реЗрдЬ рдЪреБрдиреЗ </option>
	<option value="рдЖрдзрд╛рд░ рдХрд╛рд░реНрдб">рдЖрдзрд╛рд░ рдХрд╛рд░реНрдб </option>
<option value="рдкреЗрди рдХрд╛рд░реНрдб">рдкреЗрди рдХрд╛рд░реНрдб</option>
<option value="рд╡реЛрдЯрд░ рдЖрдИрдбреА">рд╡реЛрдЯрд░ рдЖрдИрдбреА</option>
<option value="рдЬрдиреНрдо рдкреНрд░рдорд╛рдг рдкрддреНрд░">рдЬрдиреНрдо рдкреНрд░рдорд╛рдг рдкрддреНрд░</option>
<option value="рдЕрдиреНрдп">рдЕрдиреНрдп</option>
    </select>

<label for="name">рд╕рддреНрдпрд╛рдкрди рд╕реНрдерд┐рддрд┐ :-</label>
     <select id="VerificationStatus" name="verificationStatus" required>
	<option value="" disabled selected>рд╕рддреНрдпрд╛рдкрди рдХреА рд╕реНрдерд┐рддрд┐ рдЪреБрдиреЗ </option>
	 <option value="рд╕рддреНрдпрд╛рдкрд┐рдд-рдкрд╛рддреНрд░, рд╣рдЯрд╛рдпрд╛ рдирд╣реАрдВ рдЬрд╛рдирд╛ рд╣реИ">рд╕рддреНрдпрд╛рдкрд┐рдд-рдкрд╛рддреНрд░, рд╣рдЯрд╛рдпрд╛ рдирд╣реАрдВ рдЬрд╛рдирд╛ рд╣реИ</option>
	<option value="рд╕рддреНрдпрд╛рдкрд┐рдд рдирд╣реАрдВ-рдЖрд░рдВрдн рдирд╣реАрдВ рд╣реБрдЖ">рд╕рддреНрдпрд╛рдкрд┐рдд рдирд╣реАрдВ-рдЖрд░рдВрдн рдирд╣реАрдВ рд╣реБрдЖ </option>
	<option value="рд╕рддреНрдпрд╛рдкрд┐рдд-рдкрд╛рддреНрд░ рдирд╣реАрдВ">рд╕рддреНрдпрд╛рдкрд┐рдд-рдкрд╛рддреНрд░ рдирд╣реАрдВ</option>
	<option value="рд╕рддреНрдпрд╛рдкрд┐рдд рдирд╣реАрдВ-рдЬрд╛рдВрдЪ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдзреАрди">рд╕рддреНрдпрд╛рдкрд┐рдд рдирд╣реАрдВ-рдЬрд╛рдВрдЪ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдзреАрди</option>
	<option value="рдкрд╣рд▓реЗ рд╣реА рд╣рдЯрд╛рдпрд╛ рдЬрд╛ рдЪреБрдХрд╛ рд╣реИ, рдХреЛрдИ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ">рдкрд╣рд▓реЗ рд╣реА рд╣рдЯрд╛рдпрд╛ рдЬрд╛ рдЪреБрдХрд╛ рд╣реИ, рдХреЛрдИ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ</option>
	</select>

    <button type="submit">рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░реЗ </button>
  </form>
</div>
</div>
<!-- jsPDF CDN for PDF generation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
(function(){
  const url = "https://script.google.com/macros/s/AKfycbyWyBBAzRIPSO__nHm1KioZMVl_qHJqDJf5PSFzC3dvBYJ95XwCMewdF-FRk-7d-OBt/exec"; // тЖР рдпрд╣рд╛рдБ рдЕрдкрдирд╛ URL рдбрд╛рд▓реЗрдВ

  document.getElementById('form').onsubmit = async function(e){
    e.preventDefault();
 const submitBtn = e.target.querySelector('button[type="submit"]');
    submitBtn.disabled = true;
    submitBtn.textContent = 'рдХреГрдкрдпрд╛ рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░реЗрдВ...';
     const fd = new FormData(e.target);
    const data = {};                       // ЁЯФ╜ FormData рдХреЛ object рдореЗрдВ рдмрджрд▓ рд░рд╣реЗ рд╣реИрдВ
    fd.forEach((value, key) => {
      data[key] = value;
    });
   try {
      await fetch(url, {method:'POST', body:fd});
      alert('тЬЕ рдбреЗрдЯрд╛ рд╕реЗрд╡ рд╣реЛ рдЧрдпрд╛ рдФрд░ PDF рднреА рдмрди рдЧрдпрд╛');
      generatePDF(Object.fromEntries(fd));
      e.target.reset();
    } catch(err) {
      alert('тЭМ рддреНрд░реБрдЯрд┐: ' + err);
    } finally {
      submitBtn.disabled = false;
      submitBtn.textContent = 'рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░реЗ';
    }
  };

  function generatePDF(data) {
  const tempDiv = document.createElement('div');
  tempDiv.style.width = "800px";
  tempDiv.style.padding = "20px";
  tempDiv.style.background = "#fff";
  tempDiv.style.fontFamily = "Arial, sans-serif";

  tempDiv.innerHTML = `
	<div style="text-align: center;">
      <h2><b>рдЦрд╛рджреНрдп, рдирд╛рдЧрд░рд┐рдХ рдЖрдкреВрд░реНрддрд┐ рдирд┐рдЧрдо рдПрд╡рдВ рдЙрдкрднреЛрдХреНрддрд╛ рд╕рдВрд░рдХреНрд╖рдг рд╡рд┐рднрд╛рдЧ<br> рдЬрд┐рд▓рд╛ рд╕рдХреНрддреА (рдЫ.рдЧ.)</b></h2>
      <h3>рд░рд╛рд╢рдирдХрд╛рд░реНрдб рдореЗрдВ рдЙрдкрд▓рдмреНрдз рд╕рдВрджрд┐рдЧреНрдз рд▓рд╛рднрд╛рд░реНрдерд┐рдпреЛрдВ рдХреЗ рднреМрддрд┐рдХ рд╕рддреНрдпрд╛рдкрди рдХреА рдкрд╛рд╡рддреА</h3>
    </div><br><br>
 <center>   
<table border="1" cellpadding="8" cellspacing="0" style="width:90%; border-collapse:collapse; font-size:20px; margin-top:20px;">
      <thead><tr><th>рд╢реАрд░реНрд╖рдХ</th><th>рдЬрд╛рдирдХрд╛рд░реА</th></tr></thead>
      <tbody>
        <tr><td>рд░рд╛рд╢рдирдХрд╛рд░реНрдб рдХреНрд░рдорд╛рдВрдХ</td><td>${data.rashanCard}</td></tr>
        <tr><td>рд╣рд┐рддрдЧреНрд░рд╛рд╣реА рдХрд╛ рдирд╛рдо</td><td>${data.residentName}</td></tr>
        <tr><td>рд╕рддреНрдпрд╛рдкрдирдХрд░реНрддрд╛ рдЕрдзрд┐рдХрд╛рд░реА рдХрд╛ рдкрджрдирд╛рдо</td><td>${data.designation}</td></tr>
        <tr><td>рд╕рддреНрдпрд╛рдкрдирдХрд░реНрддрд╛ рдЕрдзрд┐рдХрд╛рд░реА рдХрд╛ рдирд╛рдо</td><td>${data.officerName}</td></tr>
        <tr><td>рд╕рддреНрдпрд╛рдкрди рджрд┐рдирд╛рдБрдХ</td><td>${data.verificationDate}</td></tr>
        <tr><td>рджрд╕реНрддрд╛рд╡реЗрдЬ рдкреНрд░рдорд╛рдг</td><td>${data.documentProof}</td></tr>
        <tr><td>рд╕рддреНрдпрд╛рдкрди рд╕реНрдерд┐рддрд┐</td><td>${data.verificationStatus}</td></tr>
      </tbody>
    </table></center><br><br>
    <div style="text-align:right; margin-top: 50px; font-weight: bold; font-size:20px;">рд╕рддреНрдпрд╛рдкрдирдХрд░реНрддрд╛ рдЕрдзрд┐рдХрд╛рд░реА рдХрд╛ рд╕реАрд▓ рд╡ рдирд╛рдо</div>
  
<!--
    <p><strong>рд░рд╛рд╢рдирдХрд╛рд░реНрдб рдХреНрд░рдорд╛рдВрдХ:</strong> ${data.rashanCard}</p>
    <p><strong>рд╣рд┐рддрдЧреНрд░рд╛рд╣реА рдХрд╛ рдирд╛рдо:</strong> ${data.residentName}</p>
    <p><strong>рдкрджрдирд╛рдо:</strong> ${data.designation}</p>
    <p><strong>рдЕрдзрд┐рдХрд╛рд░реА рдХрд╛ рдирд╛рдо:</strong> ${data.officerName}</p>
    <p><strong>рд╕рддреНрдпрд╛рдкрди рджрд┐рдирд╛рдБрдХ:</strong> ${data.verificationDate}</p>
    <p><strong>рджрд╕реНрддрд╛рд╡реЗрдЬ:</strong> ${data.documentProof}</p>
    <p><strong>рд╕реНрдерд┐рддрд┐:</strong> ${data.verificationStatus}</p>  -->
  `;

  // рд╕реНрдХреНрд░реАрди рд╕реЗ рд╣рдЯрд╛рдПрдВ, рдкрд░ DOM рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ рддрд╛рдХрд┐ html2canvas рдЗрд╕реЗ рдХреИрдкреНрдЪрд░ рдХрд░ рд╕рдХреЗ
  tempDiv.style.position = 'fixed';
  tempDiv.style.left = '-9999px';
  tempDiv.style.top = '0';
  document.body.appendChild(tempDiv);

  setTimeout(() => {
    html2canvas(tempDiv, { scale: 2 }).then(canvas => {
      const imgData = canvas.toDataURL('image/png');
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF('p', 'mm', 'a4');
      const pageWidth = pdf.internal.pageSize.getWidth();
      const imgHeight = (canvas.height * pageWidth) / canvas.width;

      pdf.addImage(imgData, 'PNG', 0, 0, pageWidth, imgHeight);
      pdf.save(`Verification_${data.rashanCard}.pdf`);

      document.body.removeChild(tempDiv);
    });
  }, 300); // 300ms рд╡реЗрдЯ рддрд╛рдХрд┐ DOM рдкреВрд░реА рддрд░рд╣ рддреИрдпрд╛рд░ рд╣реЛ рдЬрд╛рдП
}


})();
</script>
</body>
</html>
